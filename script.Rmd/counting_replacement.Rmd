---
title: "Counting Replacement"
author: "M. Comas-Cufí and J.A. Martin-Fernández and G. Mateu-Figueras"
date: "14/04/2015"
output: html_document
---


```{r}
library(normalmultinomial)
library(compositions)
library(dplyr)
```


```{r, include=FALSE, echo=FALSE}
# S = 2
# X1 = c(S,0,0)
# X2 = c(1,S,0)
# X3 = c(0,0,S)
# X = rbind(X1, X2, X3)
# X.nonZero  = X
# X.nonZero[X == 0] = 0.3
# 
# A = log(X.nonZero[,1:2]/X.nonZero[,3])
```

```{r}
#Paramaters
N = 200  # Number of observations
Mu = c(4, 0)
Sigma = matrix(c(1, -0.25,
                 -0.25, 1), nrow=2)
Size = 10*sample(10:50, N, replace=TRUE) # Countings for each observation
```

```{r, echo=FALSE}
X = rnormalmultinomial(mu = Mu, sigma = Sigma, size = Size)
plot.rcomp(X)
```


```{r, echo=FALSE}
fit = adjustNormalMultinomial(X = X, prop=0.7)
mu = alrInv(fit[[1]])
A = fit[[3]]
plot.rcomp(A, add = T, col='red')
plot.rcomp(mu, add =T, col='blue')
```

```{r, echo=FALSE}
plot(ilr(X), col=2)
plot(ilr(A), add=T)
```