---
title: "Fitting a sample"
author: "Marc Comas-CufÃ­"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Fitting a sample}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

#### Generating a dataset

First we load the library and fix a seed.

```{r}
library(normalmultinomial)
set.seed(1)
```

We are going to generate a sample coming from a normal-multinomial distribution with the following parameters:

```{r}
#Paramaters
N = 100  # Number of observations
Mu = c(1, 0)
Sigma = matrix(c(1, -0.75,
                 -0.75, 1), nrow=2)
Size = sample(100:500, N, replace=TRUE) # Countings for each observation
```

To generate a sample we can use function `rnorm.multinom`.

```{r}
X = rnorm.multinom(N, Mu, Sigma, Size = Size)
```

The first rows are:

```{r, echo=FALSE, results='asis'}
knitr::kable(head(X), col.names = c('X1', 'X2','X3'))
```

#### Fitting process

To fit a normal-multinomial distribution we can use function `adjustNormalMultinomial`. The function returns a list with different objects. The first two element contain the parameters $\mu$ and $\Sigma$ of the fitted normal-multinomial distribution.


```{r}
fit = adjustNormalMultinomial(X = X)
fit[1:2]
```

The thir element of list `fit` contains the hidden elements which are more likely to generate the counting `X` under the assumption that `X` was generated by a normal-multinomial distribution.
